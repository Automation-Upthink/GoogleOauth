package oauth;import com.google.api.client.googleapis.javanet.GoogleNetHttpTransport;import com.google.api.client.json.JsonFactory;import com.google.api.client.json.gson.GsonFactory;import com.google.api.services.sheets.v4.Sheets;import com.google.auth.Credentials;import com.google.auth.http.HttpCredentialsAdapter;import java.io.IOException;import java.security.GeneralSecurityException;public class SheetsServiceFactory {    private static final String APPLICATION_NAME = "My Java Sheets App";    private static final GsonFactory JSON_FACTORY = GsonFactory.getDefaultInstance();    /**     * Build a Sheets service object using the given Google credentials.     */    public static Sheets buildSheetsService(Credentials creds)            throws GeneralSecurityException, IOException {        // 1) Initialize HTTP transport        var httpTransport = GoogleNetHttpTransport.newTrustedTransport();        // 2) Wrap your creds in an HttpRequestInitializer        var requestInitializer = new HttpCredentialsAdapter(creds);        // 3) Build and return the Sheets client        return new Sheets.Builder(httpTransport, JSON_FACTORY, requestInitializer)                .setApplicationName(APPLICATION_NAME)                .build();    }}